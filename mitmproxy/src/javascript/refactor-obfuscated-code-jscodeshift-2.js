const {AstTransformer} = require("./refactor-obfuscated-code-jscodeshift-common");
const j = require('jscodeshift');

var refactorVariables = {
    '_0x1e16': 'keywords',
    '_0x35ab': 'getKeywordName',
    '_0x35ab73': 'shiftKeywords',
    '_0x5be234': 'getKeywordName',
    '_0x3b48d2': 'getKeywordName',
    '_0x31e357': 'getKeywordName',
    '_0x269024': 'getKeywordName',
    '_0x1e78b6': 'getKeywordName',
    '_0x111d23': 'getKeywordName',
    '_0x3bf102': 'getKeywordName',
    '_0x374865': 'getKeywordName',
    '_0x4ab377': 'getKeywordName',
    '_0x425961': 'getKeywordName',
    '_0x36bc43': 'getKeywordName',
    '_0x21293b': 'getKeywordName',
    '_0x5c4227': 'getKeywordName',
    '_0x395b65': 'getKeywordName',
    '_0x4a8377': 'getKeywordName',
    '_0x220c6b': 'getKeywordName',
    '_0x1b2698': 'getKeywordName',
    '_0x3dc45f': 'getKeywordName',
    '_0x5f2b94': 'getKeywordName',
    '_0x17e1be': 'getKeywordName',
    '_0x17f105': 'getKeywordName',
    '_0x5bcc42': 'getKeywordName',
    '_0x50e61a': 'getKeywordName',
    '_0x331b70': 'flattenArrays',
    '_0x3292a3': 'argumentLength',
    '_0xde2f76': 'i',
    '_0xd2b686': 'totalLength',
    '_0x4dde42': 'flattenedArray',
    '_0x56a86a': 'argumentsAtIndex',
    '_0x4a08c2': 'argumentsAtIndexLength',
    '_0x5758b8': 'flattenedArrayIndex',
    '_0x57ec14': 'j',
    '_0x3876b6': 'i',
    '_0x38dc1b': 'modules',
    '_0x588211': 'globalState',
    '_0x478891': 'tape',
    '_0x4951e9': 'functions',
    '_0x13ccc7': 'functionRef',
    '_0x2f9d74': 'i',
    '_0x2560dc': 'length',
    '_0x4b586e': 'isModule',
    '_0x36b9e1': 'isModule',
    '_0x400d47': 'error',
    '_0x21f1e2': 'getModule',
    '_0x26ea4d': 'exportedModule',
    '_0x207f9a': 'i',
    '_0x207f9a': 'argumentIndex',
    '_0x4cbc65': 'argumentsExcludingTape',
    '_0x2d1314': 'result',
    '_0x3c9cb1': 'functionIndex',
    '_0x31c854': 'functionRef',
    '_0x501cef': 'tapeStringValue',
    '_0x3fb717': 'tapeBytes',
    '_0x4a2345': 'i',
    '_0x59fe82': 'secondaryIndex',
    '_0x4616c6': 'byteValue',
    '_0xfe71f0': 'globalStateWriteIndex',
    '_0x5d873e': 'globalStateWriteStringValue',
    '_0x469d52': 'stringFromTape',
    '_0x2da1b3': 'globalStateWriteIndex',
    '_0x169cb1': 'tapeValue',
    '_0x48a4e7': 'globalStateWriteIndex',
    '_0x6a660f': 'i',
    '_0x382706': 'binaryString',
    '_0x176fa3': 'globalStateWriteIndex',
    '_0x551c19': 'globalStateReadIndex1',
    '_0x20e93a': 'globalStateReadIndex2',
    '_0x34094f': 'object',
    '_0x145f1e': 'objectKey',
    '_0x9ce0df': 'value',
    '_0x3e04b2': 'globalStateWriteIndex',
    '_0x54f086': 'functionIndex',
    '_0x325f47': 'objectIndex',
    '_0xa061d0': 'argsArray',
    '_0x149f33': 'i',
    '_0x2485db': 'length',
    '_0x4252d8': 'array',
    '_0x5281ca': 'globalStateReadIndex',
    '_0x1ab9ed': 'thisArg',
    '_0x4d68b1': 'globalStateWriteIndex',
    '_0x341434': 'value',
    '_0x598193': 'signBit',
    '_0x1178cf': 'mostSignificant11BitIntValue',
    '_0x3499c1': 'leastSignificant52BitsString',
    '_0xe6d7a3': 'leastSignificant53BitsString',
    '_0x42ae70': 'coefficient',
    '_0x15a6e8': 'binaryPlaceValue',
    '_0x2380bd': 'executionContextCoefficient',
    '_0x23f4f1': 'globalStateWriteIndex',
    '_0xfe0ab2': 'value',
    '_0x1eae29': 'i',
    '_0x112b50': 'length',
    '_0x4f9ec9': 'array',
    '_0x499eea': 'globalStateReadIndex',
    '_0x553f7f': 'globalStateWriteIndex',
    '_0x4d60c9': 'globalStateValues',
    '_0x173577': 'object',
    '_0x2494a3': 'objectKey',
    '_0x151ab1': 'value',
    '_0x51c1d1': 'globalStateReadValueIndex',
    '_0x29e127': 'globalStateReadObjectKeyIndex',
    '_0x308cfa': 'globalStateReadObjectIndex',
    '_0x42b778': 'globalStateWriteIndex',
    '_0x472240': 'errorFunctionIndex',
    '_0x565949': 'finallyFunctionIndex',
    '_0x15b8cf': 'globalStateContextsLength',
    '_0x524901': 'nextExecutionIndex',
    '_0x33fb70': 'globalStateErrorIndex',
    '_0x34595a': 'globalStateWriteIndex',
    '_0x50cc75': 'globalStateWriteIndex',
    '_0x33107e': 'evalResult',
    '_0x2fea74': 'evalString',
    '_0x4b9174': 'globalStateEvalStringIndex',
    '_0x562e0f': 'tempGlobalState',
    '_0x4044e8': 'currentExecutionIndex',
    '_0x531056': 'i',
    '_0x4f07ea': 'length',
    '_0xb05643': 'array',
    '_0x371e17': 'nextExecutionIndex',
    '_0x14f0fd': 'i',
    '_0x5d8423': 'globalStateValues',
    '_0x3fd2bb': 'globalStateWriteIndex',
    '_0x24091b': 'tempGlobalStateValue',
    '_0x52edc0': 'newGlobalState',
    '_0x1dbb37': 'globalStateWriteIndex',
    '_0x33f7c9': 'i',
    '_0x1028f8': 'newGlobalStateWriteIndex',
    '_0x1a2671': 'globalStateReadIndex',
    '_0xb28d5f': 'latestGlobalStateContext',
    '_0x398938': 'i',
    '_0x4543f2': 'length',
    '_0x1019db': 'array',
    '_0x371f61': 'globalStateValues',
    '_0x150a59': 'globalStateContextValues',
    '_0x40d2db': 'globalStateWriteIndex',
    '_0x235527': 'globalStateReadIndex',
    '_0xfac933': 'globalStateValue',
    '_0x1a170d': 'tapeLength',
    '_0xdb013c': 'nextExecutionIndex',
    '_0x5347dd': 'globalStateReadIndex',
    '_0x2be870': 'nextExecutionIndex',
    '_0x318d0d': 'nextExecutionIndex',
    '_0x171444': 'globalStateReadIndex',
    '_0x6e7f5b': 'i',
    '_0x4e2697': 'length',
    '_0x3cc25d': 'array',
    '_0x272b95': 'globalStateValues',
    '_0x356947': 'globalStateWriteIndex',
    '_0x159915': 'i',
    '_0xed3bc6': 'functionIndex',
    '_0x2534cf': 'functionResult',
    '_0x4f064d': 'globalStateWriteIndex',
    '_0x351bbf': 'looseEqualityResult',
    '_0xd8f8d6': 'input1',
    '_0x5ce549': 'input2',
    '_0x6dc523': 'globalStateReadIndex1',
    '_0x1be263': 'globalStateReadIndex2',
    '_0x4d6b2e': 'globalStateWriteIndex',
    '_0x12e799': 'looseInequalityResult',
    '_0x3566d2': 'input1',
    '_0x5d40f0': 'input2',
    '_0x2fd274': 'globalStateReadIndex1',
    '_0x1a65f0': 'globalStateReadIndex2',
    '_0x567a36': 'strictEqualityResult',
    '_0x1e9ff0': 'globalStateWriteIndex',
    '_0x28c039': 'input1',
    '_0x3a2a4a': 'input2',
    '_0x4650e3': 'globalStateReadIndex1',
    '_0x477791': 'globalStateReadIndex2',
    '_0x34339e': 'strictInequalityResult',
    '_0x17a3ec': 'globalStateWriteIndex',
    '_0xd937ed': 'input1',
    '_0x6b6a18': 'input2',
    '_0x130f01': 'globalStateReadIndex1',
    '_0x1fd853': 'globalStateReadIndex1',
    '_0x3bab13': 'ltResult',
    '_0x20fe4e': 'input1',
    '_0x359de3': 'input2',
    '_0x30c2de': 'globalStateReadIndex1',
    '_0x2cf59f': 'globalStateReadIndex2',
    '_0x18c3dd': 'ltResult',
    '_0x52e2fa': 'globalStateWriteIndex',
    '_0x392d75': 'input1',
    '_0x4be938': 'input2',
    '_0x5820b8': 'globalStateReadIndex1',
    '_0x3fc8dd': 'globalStateReadIndex2',
    '_0x1f17fe': 'lteResult',
    '_0x2dd76e': 'input1',
    '_0x504f21': 'input2',
    '_0x27bad9': 'globalStateReadIndex1',
    '_0xbce010': 'globalStateReadIndex2',
    '_0x160071': 'lteResult',
    '_0x554e07': 'globalStateWriteIndex',
    '_0x529746': 'input1',
    '_0xc25925': 'input2',
    '_0x2d31a7': 'globalStateReadIndex1',
    '_0x1aecba': 'globalStateReadIndex2',
    '_0x476aac': 'plusResult',
    '_0x2e16fc': 'input1',
    '_0x2e9efa': 'input2',
    '_0x8028a4': 'globalStateReadIndex1',
    '_0x4dc9ca': 'globalStateReadIndex2',
    '_0x301d3a': 'multiplicationResult',
    '_0x23dccc': 'input1',
    '_0x25adda': 'input2',
    '_0x11b41d': 'globalStateReadIndex1',
    '_0x69d882': 'globalStateReadIndex2',
    '_0x1ad846': 'minusResult',
    '_0x2fb376': 'input1',
    '_0x574d59': 'input2',
    '_0xfeef07': 'globalStateReadIndex1',
    '_0x50c6eb': 'globalStateReadIndex2',
    '_0x4365ea': 'divisionResult',
    '_0x2e98c6': 'input1',
    '_0x77bbe9': 'input2',
    '_0x513531': 'globalStateReadIndex1',
    '_0x1f885f': 'globalStateReadIndex2',
    '_0x529bc4': 'globalStateWriteIndex',
    '_0x552104': 'i',
    '_0x30972c': 'length',
    '_0x35d135': 'array',
    '_0x339d14': 'globalStateReadIndex',
    '_0x173465': 'globalStateValues',
    '_0xa7b7e8': 'globalStateWriteIndex',
    '_0x18bb4d': 'remainderResult',
    '_0xfe0fa3': 'globalStateWriteIndex',
    '_0x23d5e9': 'input1',
    '_0x309fe9': 'input2',
    '_0x269c9c': 'globalStateReadIndex1',
    '_0x199fc0': 'globalStateReadIndex2',
    '_0xa182e9': 'globalStateWriteIndex',
    '_0x4c90af': 'globalStateWriteIndex',
    '_0x261f22': 'globalStateWriteIndex',
    '_0x3a0a59': 'globalStateWriteIndex',
    '_0x5a8e68': 'globalStateWriteIndex',
    '_0x195bb7': 'globalStateWriteIndex',
    '_0x37b711': 'globalStateReadIndex',
    '_0x24bf20': 'functionRef',
    '_0x4ae17e': 'functionResult',
    '_0x1731a2': 'globalStateWriteIndex',
    '_0x298899': 'bitwiseAndResult',
    '_0x5a3ada': 'input1',
    '_0x2d38ca': 'input2',
    '_0x871556': 'globalStateReadIndex1',
    '_0x2ae900': 'globalStateReadIndex2',
    '_0x3f8312': 'bitwiseOrResult',
    '_0x3355d9': 'globalStateWriteIndex',
    '_0x2d7dcf': 'input1',
    '_0x6db94f': 'input2',
    '_0x27231e': 'globalStateReadIndex1',
    '_0x20f500': 'globalStateReadIndex2',
    '_0xc9378b': 'bitwiseXorResult',
    '_0x532345': 'globalStateWriteIndex',
    '_0x336a01': 'input1',
    '_0x49b9cc': 'input2',
    '_0x2baec2': 'globalStateReadIndex1',
    '_0x726e3': 'globalStateReadIndex2',
    '_0x54494b': 'bitwiseZeroFillLeftShiftResult',
    '_0x12a914': 'globalStateWriteIndex',
    '_0x45022b': 'input1',
    '_0x3094f0': 'input2',
    '_0x4d4879': 'globalStateReadIndex1',
    '_0x2709d2': 'globalStateReadIndex2',
    '_0xa5933': 'bitwiseSignedRightShiftResult',
    '_0x2cef88': 'globalStateWriteIndex',
    '_0x1f2698': 'input1',
    '_0x293eb1': 'input2',
    '_0x14d25b': 'globalStateReadIndex1',
    '_0x4c148a': 'globalStateReadIndex2',
    '_0x148f74': 'bitwiseZeroFillRightShiftResult',
    '_0x51d805': 'globalStateWriteIndex',
    '_0x4a7ead': 'input1',
    '_0x60792d': 'input2',
    '_0x3b522b': 'globalStateReadIndex1',
    '_0x30bc01': 'globalStateReadIndex2',
    '_0x5060e1': 'argumentLength',
    '_0x31a92a': 'i',
    '_0x27c019': 'globalStateWriteIndex',
    '_0x108d16': 'object',
    '_0x21b4ac': 'args',
    '_0x16f34f': 'getArgumentValue',
    '_0x32f445': 'bootstrapFunctionRef',
    '_0x3d52dd': 'rotatedArgs'
};

class RefactorVariableTransformer extends AstTransformer {
    constructor(stepNumber, jscodeshiftAst, output, outputBaseName) {
        super(stepNumber, jscodeshiftAst, output, outputBaseName);
    }

    performTransform() {
        Object.entries(refactorVariables).forEach(([key, refactoredVariableName]) => {
            this.jscodeshiftAst.findVariableDeclarators(key).renameTo(refactoredVariableName);
        });
    }
}

module.exports = {RefactorVariableTransformer};
